apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: backend-servicemonitor
  namespace: superproject-ns
  labels:
    app: apartment-system
    component: backend
    release: monitoring
    prometheus: monitoring  # CRITICAL: This label must match Prometheus serviceMonitorSelector!
spec:
  selector:
    matchLabels:
      monitoring: enabled  # Matches the label we added to backend service
  endpoints:
    - port: http  # Port name from backend service
      path: /actuator/prometheus  # Prometheus metrics endpoint
      interval: 15s  # Scrape interval
      scrapeTimeout: 10s  # Timeout for each scrape
